<!DOCTYPE html
  PUBLIC "html" "html">
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>CP2K_INPUT / FORCE_EVAL / QMMM</title>
      <meta name="language" content="en">
      <meta name="copyright" content="2000 - 2019 CP2K developers group">
      <meta name="description" content="Input for QM/MM calculations.">
      <meta name="keywords" content="scientific,computing,chemistry,physics,documentation,help,manual,Fortran,parallel,molecular dynamics,MD,density functional theory,DFT,electronic structure,linear scaling,force field,Quickstep,GPW,GAPW,FIST,QM,MM">
      <link rel="shortcut icon" href="../../favicon.png" type="image/png">
      <style type="text/css">
  a {text-decoration: none;}
  body {background-color: #ffffff;}
  code.upper {text-transform: uppercase;}
  li {margin-left: 0em; padding-left: 0em; text-indent: 0em;}
  p.uctt {font-family: monospace; text-transform: uppercase;}
  table.default {table-layout: fixed; width: 100%;}
  td.l {width: 25%;}
  td.r {width: 75%;}
  ul.circle {list-style-type: circle;}
  ul.disc {list-style-type: disc;}
  ul.index {list-style-type: none; margin-left: 0em; padding-left: 1.8em; text-indent: 0em;}
  ul.none {list-style-type: none;}
  ul.noscript {list-style-type: disc;}
  ul.square {list-style-type: square;}
  .button {font-family: monospace; font-size: 100%; cursor: pointer;}
  #html_table
  {
   border: 1px solid #000000;
   border-collapse: collapse;
   margin-left: 25px;
   padding: 6px;
   text-align: left;
   vertical-align: middle;
  }
 </style><noscript>
         <style>
   ul.index {list-style-type: disc; margin-left: 0px; padding-left: 1.8em; text-indent: 0px}
   ul.noscript {display: none}
  </style></noscript><script language="javascript" type="text/javascript" src="../../toggle_folding.js"></script></head>
   <body>
      <table class="default" summary="header">
         <tr>
            <td align="left">
               Back to the <a href="../../index.html">main page</a> of this manual
               </td>
            <td align="center">
               Input reference of CP2K version 7.0</td>
            <td align="right">
               <form method="get" action="https://www.google.com/search"><input type="text" name="q" maxlength="255"><input type="submit" value="Search this manual (Google)"><input type="hidden" name="domains" value="https://manual.cp2k.org/trunk/"><input type="radio" style="visibility:hidden" name="sitesearch" value="https://manual.cp2k.org/trunk/" checked></form>
            </td>
         </tr>
      </table>
      <hr>
      <h2><a href="../../index.html#CP2K_INPUT/FORCE_EVAL/QMMM.html">Section QMMM</a></h2>
      <ul class="none">
         <li><em>Input for QM/MM calculations.</em></li>
      </ul>
      <ul class="none">
         <li>
            Section path:
            <code class="upper"><a href="../../CP2K_INPUT.html">CP2K_INPUT</a> /
               <a href="../FORCE_EVAL.html">FORCE_EVAL</a> /
               <a href="QMMM.html">QMMM</a></code></li>
      </ul>
      <ul class="none">
         <li>
            This section cannot be repeated.
            </li>
      </ul>
      <ul class="none">
         <li>
            This section cites the following references:
            
            [<a href="../../references.html#reference_41">Laino2005</a>]
            
            [<a href="../../references.html#reference_42">Laino2006</a>]
            </li>
      </ul>
      <ul class="none">
         <li>
            <h3>Subsections</h3>
            <ul class="disc">
               <li><a href="QMMM/CELL.html">CELL</a></li>
               <li><a href="QMMM/FORCEFIELD.html">FORCEFIELD</a></li>
               <li><a href="QMMM/FORCE_MIXING.html">FORCE_MIXING</a></li>
               <li><a href="QMMM/IMAGE_CHARGE.html">IMAGE_CHARGE</a></li>
               <li><a href="QMMM/INTERPOLATOR.html">INTERPOLATOR</a></li>
               <li><a href="QMMM/LINK.html">LINK</a></li>
               <li><a href="QMMM/MM_KIND.html">MM_KIND</a></li>
               <li><a href="QMMM/PERIODIC.html">PERIODIC</a></li>
               <li><a href="QMMM/PRINT.html">PRINT</a></li>
               <li><a href="QMMM/QM_KIND.html">QM_KIND</a></li>
               <li><a href="QMMM/WALLS.html">WALLS</a></li>
            </ul>
         </li>
      </ul>
      <ul class="none">
         <li>
            <h3>Keywords</h3>
            <ul class="disc">
               <li><a href="#CENTER" id="list_CENTER">CENTER</a></li>
               <li><a href="#CENTER_GRID" id="list_CENTER_GRID">CENTER_GRID</a></li>
               <li><a href="#CENTER_TYPE" id="list_CENTER_TYPE">CENTER_TYPE</a></li>
               <li><a href="#DELTA_CHARGE" id="list_DELTA_CHARGE">DELTA_CHARGE</a></li>
               <li><a href="#EPS_MM_RSPACE" id="list_EPS_MM_RSPACE">EPS_MM_RSPACE</a></li>
               <li><a href="#E_COUPL" id="list_E_COUPL">E_COUPL</a></li>
               <li><a href="#INITIAL_TRANSLATION_VECTOR" id="list_INITIAL_TRANSLATION_VECTOR">INITIAL_TRANSLATION_VECTOR</a></li>
               <li><a href="#MM_POTENTIAL_FILE_NAME" id="list_MM_POTENTIAL_FILE_NAME">MM_POTENTIAL_FILE_NAME</a></li>
               <li><a href="#NOCOMPATIBILITY" id="list_NOCOMPATIBILITY">NOCOMPATIBILITY</a></li>
               <li><a href="#PARALLEL_SCHEME" id="list_PARALLEL_SCHEME">PARALLEL_SCHEME</a></li>
               <li><a href="#SPHERICAL_CUTOFF" id="list_SPHERICAL_CUTOFF">SPHERICAL_CUTOFF</a></li>
               <li><a href="#USE_GEEP_LIB" id="list_USE_GEEP_LIB">USE_GEEP_LIB</a></li>
            </ul>
         </li>
      </ul>
      <ul class="none">
         <li>
            <h3>Keyword descriptions</h3>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_CENTER"></a><a href="#list_CENTER" id="CENTER">CENTER</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">CENTER</code><code>&nbsp;{Keyword}</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>This keyword sets when the QM system is automatically centered.  Default is EVERY_STEP.</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     precisely one keyword.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default value:
                     <code class="upper">EVERY_STEP</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     List of valid keywords:
                     
                     <ul class="square">
                        <li>
                           <dl>
                              <dt><code class="upper">EVERY_STEP</code></dt>
                              <dd><em>Re-center every step</em></dd>
                           </dl>
                        </li>
                        <li>
                           <dl>
                              <dt><code class="upper">NEVER</code></dt>
                              <dd><em>Never center</em></dd>
                           </dl>
                        </li>
                        <li>
                           <dl>
                              <dt><code class="upper">SETUP_ONLY</code></dt>
                              <dd><em>Center at first step only</em></dd>
                           </dl>
                        </li>
                     </ul>
                  </td>
               </tr>
            </table>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_CENTER_GRID"></a><a href="#list_CENTER_GRID" id="CENTER_GRID">CENTER_GRID</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">CENTER_GRID</code><code>&nbsp;{Logical}</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>This keyword specifies whether the QM system is centered in units of the grid spacing.</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     precisely one logical.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default value:
                     <code class="upper">.FALSE.</code></td>
               </tr>
            </table>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_CENTER_TYPE"></a><a href="#list_CENTER_TYPE" id="CENTER_TYPE">CENTER_TYPE</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">CENTER_TYPE</code><code>&nbsp;{Keyword}</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>This keyword specifies how to do the QM system centering.</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     precisely one keyword.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default value:
                     <code class="upper">MAX_MINUS_MIN</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     List of valid keywords:
                     
                     <ul class="square">
                        <li>
                           <dl>
                              <dt><code class="upper">MAX_MINUS_MIN</code></dt>
                              <dd><em>Center of box defined by maximum coordinate minus minimum coordinate</em></dd>
                           </dl>
                        </li>
                        <li>
                           <dl>
                              <dt><code class="upper">PBC_AWARE_MAX_MINUS_MIN</code></dt>
                              <dd><em>PBC-aware centering (useful for &QMMM&FORCE_MIXING)</em></dd>
                           </dl>
                        </li>
                     </ul>
                  </td>
               </tr>
            </table>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_DELTA_CHARGE"></a><a href="#list_DELTA_CHARGE" id="DELTA_CHARGE">DELTA_CHARGE</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">DELTA_CHARGE</code><code>&nbsp;{Integer}</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>Additional net charge relative to that specified in DFT section.  Used automatically by force mixing</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     precisely one integer.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default value:
                     <code class="upper">0</code></td>
               </tr>
            </table>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_EPS_MM_RSPACE"></a><a href="#list_EPS_MM_RSPACE" id="EPS_MM_RSPACE">EPS_MM_RSPACE</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">EPS_MM_RSPACE</code><code>&nbsp;{Real}</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>Set the threshold for the collocation of the GEEP gaussian functions.this keyword affects only the GAUSS E_COUPLING.</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     precisely one real.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default value:
                     <code class="upper">1.00000000E-010</code></td>
               </tr>
            </table>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_E_COUPL"></a><a href="#list_E_COUPL" id="E_COUPL">E_COUPL</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">E_COUPL</code><code>&nbsp;{Keyword}</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>Specifies the type of the QM - MM electrostatic coupling.</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     precisely one keyword.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default value:
                     <code class="upper">NONE</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     List of valid keywords:
                     
                     <ul class="square">
                        <li>
                           <dl>
                              <dt><code class="upper">COULOMB</code></dt>
                              <dd><em>Using analytical 1/r potential (Coulomb) - not available for GPW/GAPW</em></dd>
                           </dl>
                        </li>
                        <li>
                           <dl>
                              <dt><code class="upper">GAUSS</code></dt>
                              <dd><em>Using fast gaussian expansion of the electrostatic potential (Erf(r/rc)/r) - not available for DFTB.</em></dd>
                           </dl>
                        </li>
                        <li>
                           <dl>
                              <dt><code class="upper">NONE</code></dt>
                              <dd><em>Mechanical coupling (i.e. classical point charge based)</em></dd>
                           </dl>
                        </li>
                        <li>
                           <dl>
                              <dt><code class="upper">POINT_CHARGE</code></dt>
                              <dd><em>Using quantum mechanics derived point charges interacting with MM charges</em></dd>
                           </dl>
                        </li>
                        <li>
                           <dl>
                              <dt><code class="upper">S-WAVE</code></dt>
                              <dd><em>Using fast gaussian expansion of the s-wave electrostatic potential</em></dd>
                           </dl>
                        </li>
                     </ul>
                  </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Alias names for this keyword:
                     QMMM_COUPLING,
                     ECOUPL</td>
               </tr>
            </table>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_INITIAL_TRANSLATION_VECTOR"></a><a href="#list_INITIAL_TRANSLATION_VECTOR" id="INITIAL_TRANSLATION_VECTOR">INITIAL_TRANSLATION_VECTOR</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">INITIAL_TRANSLATION_VECTOR</code><code>&nbsp;{Real}</code><code>&nbsp;{Real}</code><code>&nbsp;{Real}</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>This keyword specify the initial translation vector to be applied to the system.</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     precisely 3&nbsp;reals.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default values:
                     <code class="upper">0.00000000E+000 0.00000000E+000 0.00000000E+000</code></td>
               </tr>
            </table>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_MM_POTENTIAL_FILE_NAME"></a><a href="#list_MM_POTENTIAL_FILE_NAME" id="MM_POTENTIAL_FILE_NAME">MM_POTENTIAL_FILE_NAME</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">MM_POTENTIAL_FILE_NAME</code><code>&nbsp;{String}</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>Name of the file containing the potential expansion in gaussians. See the USE_GEEP_LIB keyword.</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     precisely one string.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default value:
                     <code class="upper">MM_POTENTIAL</code></td>
               </tr>
            </table>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_NOCOMPATIBILITY"></a><a href="#list_NOCOMPATIBILITY" id="NOCOMPATIBILITY">NOCOMPATIBILITY</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">NOCOMPATIBILITY</code><code>&nbsp;{Logical}</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>This keyword disables the compatibility of QM/MM potential between CPMD and CP2K implementations. The compatibility is achieved using an MM potential of the form: Erf[x/rc]/x + (1/rc -2/(pi^1/2*rc))*Exp[-(x/rc)^2] .This keyword has effect only selecting GAUSS E_COUPLING type.</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     precisely one logical.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     The lone keyword behaves as a switch to
                     <code class="upper">.TRUE.</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default value:
                     <code class="upper">.FALSE.</code></td>
               </tr>
            </table>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_PARALLEL_SCHEME"></a><a href="#list_PARALLEL_SCHEME" id="PARALLEL_SCHEME">PARALLEL_SCHEME</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">PARALLEL_SCHEME</code><code>&nbsp;{Keyword}</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>Chooses the parallel_scheme for the long range Potential</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     precisely one keyword.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default value:
                     <code class="upper">ATOM</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     List of valid keywords:
                     
                     <ul class="square">
                        <li>
                           <dl>
                              <dt><code class="upper">ATOM</code></dt>
                              <dd><em>parallelizes on atoms. grids replicated. Replication of the grids can be quite expensive memory wise if running on a system with limited memory per core. The grid option may be preferred in this case.</em></dd>
                           </dl>
                        </li>
                        <li>
                           <dl>
                              <dt><code class="upper">GRID</code></dt>
                              <dd><em>parallelizes on grid slices. atoms replicated.</em></dd>
                           </dl>
                        </li>
                     </ul>
                  </td>
               </tr>
            </table>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_SPHERICAL_CUTOFF"></a><a href="#list_SPHERICAL_CUTOFF" id="SPHERICAL_CUTOFF">SPHERICAL_CUTOFF</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">SPHERICAL_CUTOFF</code><code>&nbsp;{Real}</code><code>&nbsp;{Real}</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>Set the spherical cutoff for the QMMM electrostatic interaction. This acts like a charge multiplicative factor dependent on cutoff. For MM atoms farther than the SPHERICAL_CUTOFF(1) their charge is zero. The switch is performed with a smooth function: 0.5*(1-TANH((r-[SPH_CUT(1)-20*SPH_CUT(2)])/(SPH_CUT(2)))). Two values are required: the first one is the distance cutoff. The second one controls the stiffness of the smoothing.</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     precisely 2&nbsp;reals.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default values:
                     <code class="upper">-5.29177209E-001 0.00000000E+000</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><a href="../../units.html">Default unit:</a><code>
                        [angstrom]
                        </code></td>
               </tr>
            </table>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_USE_GEEP_LIB"></a><a href="#list_USE_GEEP_LIB" id="USE_GEEP_LIB">USE_GEEP_LIB</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">USE_GEEP_LIB</code><code>&nbsp;{Integer}</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em> This keyword enables the use of the internal GEEP library to generate the gaussian expansion of the MM potential. Using this keyword there's no need to provide the MM_POTENTIAL_FILENAME. It expects a number from 2 to 15 (the number of gaussian funtions to be used in the expansion.</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     precisely one integer.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default value:
                     <code class="upper">0</code></td>
               </tr>
            </table>
         </li>
      </ul>
      <hr>
      <table class="default" summary="footer">
         <tr>
            <td align="left">
               Back to the <a href="../../index.html">main page</a> of this manual or the <a href="https://www.cp2k.org">CP2K home page</a></td>
            <td align="right">
               (Last update:
               2.9.2019)
               </td>
         </tr>
      </table>
   </body>
</html>
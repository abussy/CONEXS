<!DOCTYPE html
  PUBLIC "html" "html">
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>CP2K_INPUT / FORCE_EVAL / DFT / QS / CDFT / OUTER_SCF / CDFT_OPT</title>
      <meta name="language" content="en">
      <meta name="copyright" content="2000 - 2019 CP2K developers group">
      <meta name="description" content="Parameters controlling optimization methods that are compatible only with CDFT based constraints (i.e. CDFT SCF is active). Specifically, the control parameters for the Broyden and Newton optimizers are defined in this section.">
      <meta name="keywords" content="scientific,computing,chemistry,physics,documentation,help,manual,Fortran,parallel,molecular dynamics,MD,density functional theory,DFT,electronic structure,linear scaling,force field,Quickstep,GPW,GAPW,FIST,QM,MM">
      <link rel="shortcut icon" href="../../../../../../favicon.png" type="image/png">
      <style type="text/css">
  a {text-decoration: none;}
  body {background-color: #ffffff;}
  code.upper {text-transform: uppercase;}
  li {margin-left: 0em; padding-left: 0em; text-indent: 0em;}
  p.uctt {font-family: monospace; text-transform: uppercase;}
  table.default {table-layout: fixed; width: 100%;}
  td.l {width: 25%;}
  td.r {width: 75%;}
  ul.circle {list-style-type: circle;}
  ul.disc {list-style-type: disc;}
  ul.index {list-style-type: none; margin-left: 0em; padding-left: 1.8em; text-indent: 0em;}
  ul.none {list-style-type: none;}
  ul.noscript {list-style-type: disc;}
  ul.square {list-style-type: square;}
  .button {font-family: monospace; font-size: 100%; cursor: pointer;}
  #html_table
  {
   border: 1px solid #000000;
   border-collapse: collapse;
   margin-left: 25px;
   padding: 6px;
   text-align: left;
   vertical-align: middle;
  }
 </style><noscript>
         <style>
   ul.index {list-style-type: disc; margin-left: 0px; padding-left: 1.8em; text-indent: 0px}
   ul.noscript {display: none}
  </style></noscript><script language="javascript" type="text/javascript" src="../../../../../../toggle_folding.js"></script></head>
   <body>
      <table class="default" summary="header">
         <tr>
            <td align="left">
               Back to the <a href="../../../../../../index.html">main page</a> of this manual
               </td>
            <td align="center">
               Input reference of CP2K version 7.0</td>
            <td align="right">
               <form method="get" action="https://www.google.com/search"><input type="text" name="q" maxlength="255"><input type="submit" value="Search this manual (Google)"><input type="hidden" name="domains" value="https://manual.cp2k.org/trunk/"><input type="radio" style="visibility:hidden" name="sitesearch" value="https://manual.cp2k.org/trunk/" checked></form>
            </td>
         </tr>
      </table>
      <hr>
      <h2><a href="../../../../../../index.html#CP2K_INPUT/FORCE_EVAL/DFT/QS/CDFT/OUTER_SCF/CDFT_OPT.html">Section CDFT_OPT</a></h2>
      <ul class="none">
         <li><em>Parameters controlling optimization methods that are compatible only with CDFT based constraints (i.e. CDFT SCF is active). Specifically, the control parameters for the Broyden and Newton optimizers are defined in this section.</em></li>
      </ul>
      <ul class="none">
         <li>
            Section path:
            <code class="upper"><a href="../../../../../../CP2K_INPUT.html">CP2K_INPUT</a> /
               <a href="../../../../../FORCE_EVAL.html">FORCE_EVAL</a> /
               <a href="../../../../DFT.html">DFT</a> /
               <a href="../../../QS.html">QS</a> /
               <a href="../../CDFT.html">CDFT</a> /
               <a href="../OUTER_SCF.html">OUTER_SCF</a> /
               <a href="CDFT_OPT.html">CDFT_OPT</a></code></li>
      </ul>
      <ul class="none">
         <li>
            This section cannot be repeated.
            </li>
      </ul>
      <ul class="none">
         <li>
            <h3>Subsections</h3>
            <ul class="disc">
               <li>
                  none
                  </li>
            </ul>
         </li>
      </ul>
      <ul class="none">
         <li>
            <h3>Keywords</h3>
            <ul class="disc">
               <li><a href="#BROYDEN_TYPE" id="list_BROYDEN_TYPE">BROYDEN_TYPE</a></li>
               <li><a href="#CONTINUE_LS" id="list_CONTINUE_LS">CONTINUE_LS</a></li>
               <li><a href="#FACTOR_LS" id="list_FACTOR_LS">FACTOR_LS</a></li>
               <li><a href="#JACOBIAN_FREQ" id="list_JACOBIAN_FREQ">JACOBIAN_FREQ</a></li>
               <li><a href="#JACOBIAN_RESTART" id="list_JACOBIAN_RESTART">JACOBIAN_RESTART</a></li>
               <li><a href="#JACOBIAN_STEP" id="list_JACOBIAN_STEP">JACOBIAN_STEP</a></li>
               <li><a href="#JACOBIAN_TYPE" id="list_JACOBIAN_TYPE">JACOBIAN_TYPE</a></li>
               <li><a href="#JACOBIAN_VECTOR" id="list_JACOBIAN_VECTOR">JACOBIAN_VECTOR</a></li>
               <li><a href="#MAX_LS" id="list_MAX_LS">MAX_LS</a></li>
            </ul>
         </li>
      </ul>
      <ul class="none">
         <li>
            <h3>Keyword descriptions</h3>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_BROYDEN_TYPE"></a><a href="#list_BROYDEN_TYPE" id="BROYDEN_TYPE">BROYDEN_TYPE</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">BROYDEN_TYPE</code><code>&nbsp;{Keyword}</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>Specifies the Broyden optimizer variant to use.</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     precisely one keyword.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default value:
                     <code class="upper">BT1</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     List of valid keywords:
                     
                     <ul class="square">
                        <li>
                           <dl>
                              <dt><code class="upper">BT1</code></dt>
                              <dd><em>Broyden's first method, also known as the good method. The initial Jacobian is built from MD history if available. Otherwise switches to SD for one SCF iteration until a Jacobian can be built from the SCF history.</em></dd>
                           </dl>
                        </li>
                        <li>
                           <dl>
                              <dt><code class="upper">BT1_EXPLICIT</code></dt>
                              <dd><em>Same as BT1, but computes the explicit Jacobian with finite differences. Requires a CDFT SCF procedure to be active.</em></dd>
                           </dl>
                        </li>
                        <li>
                           <dl>
                              <dt><code class="upper">BT1_EXPLICIT_LS</code></dt>
                              <dd><em>Same as BT1_EXPLICIT, but uses backtracking line search for optimizing the step size.</em></dd>
                           </dl>
                        </li>
                        <li>
                           <dl>
                              <dt><code class="upper">BT1_LS</code></dt>
                              <dd><em>Same as BT1, but uses backtracking line search for optimizing the step size (see optimizer NEWTON_LS).</em></dd>
                           </dl>
                        </li>
                        <li>
                           <dl>
                              <dt><code class="upper">BT2</code></dt>
                              <dd><em>Same as BT1, but uses Broyden's second method, also known as the bad method.</em></dd>
                           </dl>
                        </li>
                        <li>
                           <dl>
                              <dt><code class="upper">BT2_EXPLICIT</code></dt>
                              <dd><em>Same as BT1_EXPLICIT, but using Broyden's second method.</em></dd>
                           </dl>
                        </li>
                        <li>
                           <dl>
                              <dt><code class="upper">BT2_EXPLICIT_LS</code></dt>
                              <dd><em>Same as BT2_EXPLICIT, but uses backtracking line search for optimizing the step size.</em></dd>
                           </dl>
                        </li>
                        <li>
                           <dl>
                              <dt><code class="upper">BT2_LS</code></dt>
                              <dd><em>Same as BT2, but uses backtracking line search for optimizing the step size.</em></dd>
                           </dl>
                        </li>
                     </ul>
                  </td>
               </tr>
            </table>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_CONTINUE_LS"></a><a href="#list_CONTINUE_LS" id="CONTINUE_LS">CONTINUE_LS</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">CONTINUE_LS</code><code>&nbsp;{Logical}</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>Continue backtracking line search until MAX_LS steps are reached or the norm of the CDFT gradient no longer decreases. Default (false) behavior exits the line search procedure on the first step that the gradient decreases.</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     precisely one logical.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     The lone keyword behaves as a switch to
                     <code class="upper">.TRUE.</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default value:
                     <code class="upper">.FALSE.</code></td>
               </tr>
            </table>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_FACTOR_LS"></a><a href="#list_FACTOR_LS" id="FACTOR_LS">FACTOR_LS</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">FACTOR_LS</code><code>&nbsp;{Real}</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>Control parameter for backtracking line search. The step size is reduced by this factor on every line search iteration. Value must be between 0 and 1 (exclusive).</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     precisely one real.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default value:
                     <code class="upper">5.00000000E-001</code></td>
               </tr>
            </table>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_JACOBIAN_FREQ"></a><a href="#list_JACOBIAN_FREQ" id="JACOBIAN_FREQ">JACOBIAN_FREQ</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">JACOBIAN_FREQ</code><code>&nbsp;{Integer}</code><code>&nbsp;{Integer}</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>Defines parameters that control how often the explicit Jacobian is built, which is needed by some optimizers. Expects two values. The first value determines how many consecutive CDFT SCF iterations should skip a rebuild, whereas the latter how many MD steps. The values can be zero (meaning never  rebuild) or positive. Both values cannot be zero.</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     precisely 2&nbsp;integers.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default values:
                     <code class="upper">1 1</code></td>
               </tr>
            </table>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_JACOBIAN_RESTART"></a><a href="#list_JACOBIAN_RESTART" id="JACOBIAN_RESTART">JACOBIAN_RESTART</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">JACOBIAN_RESTART</code><code>&nbsp;{Logical}</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>Restart the inverse Jacobian using the vector defined with keyword JACOBIAN_VECTOR.</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     precisely one logical.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     The lone keyword behaves as a switch to
                     <code class="upper">.TRUE.</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default value:
                     <code class="upper">.FALSE.</code></td>
               </tr>
            </table>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_JACOBIAN_STEP"></a><a href="#list_JACOBIAN_STEP" id="JACOBIAN_STEP">JACOBIAN_STEP</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">JACOBIAN_STEP</code><code>&nbsp;{Real}&nbsp;...</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>Step size to use in the calculation of the inverse Jacobian with finite differences. Expects one value for all constraints, or one value per constraint.</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     a list of reals.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default value:
                     <code class="upper">5.00000000E-003</code></td>
               </tr>
            </table>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_JACOBIAN_TYPE"></a><a href="#list_JACOBIAN_TYPE" id="JACOBIAN_TYPE">JACOBIAN_TYPE</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">JACOBIAN_TYPE</code><code>&nbsp;{Keyword}</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>Finite difference method used to calculate the inverse Jacobian needed by some optimizers. Compatible only with CDFT constraints.</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     precisely one keyword.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default value:
                     <code class="upper">FD1</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     List of valid keywords:
                     
                     <ul class="square">
                        <li>
                           <dl>
                              <dt><code class="upper">FD1</code></dt>
                              <dd><em>First order forward difference (one extra energy evaluation per constraint).</em></dd>
                           </dl>
                        </li>
                        <li>
                           <dl>
                              <dt><code class="upper">FD1_BACKWARD</code></dt>
                              <dd><em>First order backward difference (one extra energy evaluation per constraint).</em></dd>
                           </dl>
                        </li>
                        <li>
                           <dl>
                              <dt><code class="upper">FD1_CENTRAL</code></dt>
                              <dd><em>First order central difference (two extra energy evaluations per constraint).</em></dd>
                           </dl>
                        </li>
                        <li>
                           <dl>
                              <dt><code class="upper">FD2</code></dt>
                              <dd><em>Second order forward difference (two extra energy evaluations per constraint).</em></dd>
                           </dl>
                        </li>
                        <li>
                           <dl>
                              <dt><code class="upper">FD2_BACKWARD</code></dt>
                              <dd><em>Second order backward difference (two extra energy evaluations per constraint).</em></dd>
                           </dl>
                        </li>
                     </ul>
                  </td>
               </tr>
            </table>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_JACOBIAN_VECTOR"></a><a href="#list_JACOBIAN_VECTOR" id="JACOBIAN_VECTOR">JACOBIAN_VECTOR</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">JACOBIAN_VECTOR</code><code>&nbsp;{Real}&nbsp;...</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>Defines the inverse Jacobian matrix. Useful for restarting calculations. Expects n^2 values where n is the total number of constraints. The matrix should be given in row major order.</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     a list of reals.
                     </td>
               </tr>
            </table>
            <table class="default" summary="keyword_description">
               <tr>
                  <td class="l">
                     <ul class="disc">
                        <li><a id="desc_MAX_LS"></a><a href="#list_MAX_LS" id="MAX_LS">MAX_LS</a></li>
                     </ul>
                  </td>
                  <td class="r"></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><code class="upper">MAX_LS</code><code>&nbsp;{Integer}</code></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r"><em>The maximum number of backtracking line search steps to perform.</em></td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     This keyword cannot be repeated
                     and it expects
                     
                     precisely one integer.
                     </td>
               </tr>
               <tr>
                  <td class="l"></td>
                  <td class="r">
                     Default value:
                     <code class="upper">5</code></td>
               </tr>
            </table>
         </li>
      </ul>
      <hr>
      <table class="default" summary="footer">
         <tr>
            <td align="left">
               Back to the <a href="../../../../../../index.html">main page</a> of this manual or the <a href="https://www.cp2k.org">CP2K home page</a></td>
            <td align="right">
               (Last update:
               2.9.2019)
               </td>
         </tr>
      </table>
   </body>
</html>